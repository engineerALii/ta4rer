<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø­Ø±Ø± Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ | ØºÙ„Ø§Ù + ØªÙ‚Ø±ÙŠØ±</title>
    <style>
        /* =========================================
           1. CORE VARIABLES & RESET
           ========================================= */
        :root {
            --glass-bg: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.5);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --text-main: #1e293b;
            --text-secondary: #64748b;
            --danger: #ef4444;
            --success: #10b981;
            
            /* Font Stacks */
            --font-sans: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-serif: 'Times New Roman', Times, serif;
            --font-academic: 'Traditional Arabic', 'Simplified Arabic', serif;
            --font-kufi: 'Tahoma', 'Segoe UI', sans-serif;
            --font-digital: 'Courier New', Courier, monospace;

            /* Transitions */
            --trans-speed: 0.3s;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            outline: none;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 100%);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* Decorative Background */
        .bg-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.6;
        }
        .bg-orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #bfdbfe; }
        .bg-orb-2 { bottom: -10%; right: -10%; width: 50vw; height: 50vw; background: #ddd6fe; }

        /* =========================================
           2. NAVIGATION TABS
           ========================================= */
        .main-nav {
            display: flex;
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            padding: 5px;
            border-radius: 16px;
            box-shadow: var(--glass-shadow);
            margin-bottom: 25px;
            position: sticky;
            top: 10px;
            z-index: 100;
            border: 1px solid var(--glass-border);
        }

        .nav-item {
            padding: 12px 25px;
            cursor: pointer;
            border-radius: 12px;
            font-weight: 700;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-item:hover { color: var(--primary-color); background: rgba(37, 99, 235, 0.05); }

        .nav-item.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        /* =========================================
           3. LAYOUT & SECTIONS
           ========================================= */
        .app-container {
            width: 100%;
            max-width: 1400px;
            position: relative;
        }

        .section-view {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .section-view.active {
            display: flex; /* Or block depending on specific layout */
            opacity: 1;
            transform: translateY(0);
        }

        /* Cover Section Specifics */
        #view-cover {
            gap: 30px;
            flex-wrap: wrap;
        }

        /* Editor Section Specifics */
        #view-editor {
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* =========================================
           4. CONTROLS PANEL (Shared Styles)
           ========================================= */
        .controls-panel {
            flex: 1;
            min-width: 320px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--glass-shadow);
            height: fit-content;
            /* position: sticky is handled in media queries */
        }

        .preview-panel {
            flex: 2;
            min-width: 350px;
            display: flex;
            justify-content: center;
            padding-bottom: 50px;
            container-type: inline-size;
        }

        /* Form Elements */
        h1 { font-size: 1.5rem; margin-bottom: 20px; color: #0f172a; display: flex; align-items: center; gap: 10px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.85rem; color: var(--text-secondary); }
        input[type="text"], select {
            width: 100%; padding: 10px 12px; border-radius: 8px; border: 1px solid #cbd5e1;
            background: rgba(255, 255, 255, 0.9); font-family: inherit; font-size: 0.95rem;
            transition: all 0.2s ease;
        }
        input[type="text"]:focus, select:focus { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); background: #fff; }

        /* Buttons */
        .btn { border: none; cursor: pointer; border-radius: 8px; font-family: inherit; font-weight: 600; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-icon { padding: 10px; flex-shrink: 0; }
        .btn-add { background: #f1f5f9; color: var(--primary-color); padding: 8px; width: 100%; margin-top: 8px; }
        .btn-remove { background: #fee2e2; color: var(--danger); }
        .btn-print { background: var(--primary-color); color: white; padding: 14px; width: 100%; margin-top: 25px; font-size: 1.1rem; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25); }
        .btn-print:hover { background: var(--primary-hover); transform: translateY(-1px); }

        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .student-list { display: flex; flex-direction: column; gap: 8px; }
        .student-entry { display: flex; gap: 8px; animation: slideDown 0.2s ease; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* =========================================
           5. EDITOR STYLES (New Feature)
           ========================================= */
        .editor-wrapper {
            width: 100%;
            max-width: 210mm; /* A4 width */
            margin: 0 auto;
        }

        /* Toolbar */
        .editor-toolbar {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            position: sticky;
            top: 80px; /* Below nav */
            z-index: 90;
        }

        .tool-group {
            display: flex;
            gap: 5px;
            padding-left: 10px;
            border-left: 1px solid #e2e8f0;
            align-items: center;
        }
        .tool-group:last-child { border-left: none; }

        .tool-btn {
            background: transparent;
            border: 1px solid transparent;
            border-radius: 6px;
            padding: 6px 10px;
            cursor: pointer;
            font-size: 1rem;
            color: var(--text-main);
        }
        .tool-btn:hover { background: rgba(0,0,0,0.05); }
        .tool-btn.active { background: #e0f2fe; color: var(--primary-color); }

        /* The Paper */
        .editor-paper {
            background: white;
            width: 100%;
            min-height: 297mm;
            padding: 25.4mm; /* Standard 1 inch margins */
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            font-size: 14pt;
            line-height: 1.6;
            color: #000;
            position: relative;
            outline: none;
            direction: rtl;
        }

        .editor-paper[contenteditable]:empty::before {
            content: 'Ø§Ø¨Ø¯Ø£ ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù‡Ù†Ø§...';
            color: #94a3b8;
        }

        /* Page Break Visual */
        .page-break-marker {
            border-bottom: 2px dashed #cbd5e1;
            margin: 20px -25.4mm;
            position: relative;
            height: 20px;
            page-break-after: always;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 0.8rem;
            pointer-events: none;
        }
        .page-break-marker::after { content: 'ÙØ§ØµÙ„ ØµÙØ­Ø§Øª (Ø¹Ù†Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©)'; background: #f1f5f9; padding: 0 10px; }

        /* Stats Bar */
        .editor-stats {
            margin-top: 15px;
            display: flex;
            gap: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            justify-content: flex-end;
            padding: 0 10px;
        }

        /* =========================================
           6. A4 PREVIEW (Cover)
           ========================================= */
        .a4-wrapper {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            transform-origin: top center;
            transition: all 0.3s ease;
            overflow: hidden;
            color: #000;
        }
        /* ... (Kept existing theme styles below) ... */
        .report-header { margin-bottom: 40px; position: relative; z-index: 2; }
        .report-body { position: relative; z-index: 2; min-height: 500px; display: flex; flex-direction: column; justify-content: center; }
        .report-footer { position: absolute; bottom: 15mm; left: 0; width: 100%; text-align: center; padding: 0 20mm; z-index: 2; }
        .uni-logo-placeholder { width: 80px; height: 80px; background: #f8fafc; border: 2px dashed #cbd5e1; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; margin: 0 auto 15px; color: #64748b; }
        .uni-name-text { font-size: 1.4rem; font-weight: bold; margin-bottom: 5px; }
        .report-title { font-size: 2.2rem; font-weight: 800; margin: 30px 0; line-height: 1.3; }
        .report-meta { width: 100%; max-width: 80%; margin: 0 auto; text-align: right; }
        .meta-row { display: flex; margin-bottom: 12px; font-size: 1.1rem; border-bottom: 1px solid transparent; padding-bottom: 4px; }
        .meta-label { font-weight: bold; width: 140px; flex-shrink: 0; opacity: 0.8; }
        .meta-value { flex-grow: 1; }
        
        /* Themes & Fonts */
        [data-theme="formal"] { border: 1px solid #ccc; }
        [data-theme="formal"] .report-header { text-align: center; border-bottom: 3px double #000; padding-bottom: 20px; }
        [data-theme="formal"] .report-title { text-align: center; text-decoration: underline; text-underline-offset: 8px; }
        [data-theme="formal"] .report-meta { border: 1px solid #000; padding: 20px; }

        [data-theme="modern"] .report-header { text-align: center; }
        [data-theme="modern"]::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 20mm; background: linear-gradient(to right, #2563eb, #60a5fa); }
        [data-theme="modern"] .uni-logo-placeholder { background: white; border: none; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-top: 5mm; }
        [data-theme="modern"] .report-title { color: #2563eb; text-align: center; }
        [data-theme="modern"] .report-footer { border-top: 2px solid #2563eb; padding-top: 10px; }

        [data-theme="corporate"] { padding: 0; display: flex; }
        [data-theme="corporate"]::before { content: ''; position: absolute; top: 0; right: 0; bottom: 0; width: 60mm; background: #1e293b; z-index: 0; }
        [data-theme="corporate"] .report-content-wrapper { position: relative; z-index: 1; width: 100%; height: 100%; padding: 20mm; display: flex; flex-direction: column; }
        [data-theme="corporate"] .report-header { text-align: right; color: white; margin-right: -10mm; margin-top: 10mm; margin-bottom: 60px; }
        [data-theme="corporate"] .uni-logo-placeholder { border-color: rgba(255,255,255,0.2); background: rgba(255,255,255,0.1); color: white; margin: 0 0 20px auto; }
        [data-theme="corporate"] .uni-name-text { color: white; }
        [data-theme="corporate"] .report-body { text-align: left; padding-right: 50mm; align-items: flex-start; }
        [data-theme="corporate"] .report-title { text-align: left; font-size: 3rem; color: #1e293b; border-left: 10px solid #f59e0b; padding-left: 20px; }
        [data-theme="corporate"] .report-meta { text-align: left; margin: 0; max-width: 100%; }
        [data-theme="corporate"] .meta-row { flex-direction: row; }

        [data-theme="elegant"] { border: 8px solid #f1f1f1; }
        [data-theme="elegant"] .report-header { text-align: center; }
        [data-theme="elegant"] .uni-logo-placeholder { display: none; }
        [data-theme="elegant"] .uni-name-text { font-family: var(--font-serif); font-style: italic; color: #555; font-size: 1.2rem; }
        [data-theme="elegant"] .report-title { font-family: var(--font-serif); font-weight: normal; font-size: 2.8rem; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd; padding: 40px 0; text-align: center; }
        [data-theme="elegant"] .meta-row { justify-content: center; text-align: center; }

        [data-theme="creative"] { overflow: hidden; }
        [data-theme="creative"]::before { content: ''; position: absolute; top: -100px; left: -100px; width: 300px; height: 300px; background: #ec4899; border-radius: 50%; opacity: 0.1; }
        [data-theme="creative"]::after { content: ''; position: absolute; bottom: -50px; right: -50px; width: 400px; height: 400px; background: #8b5cf6; border-radius: 50%; opacity: 0.1; z-index: 0; }
        [data-theme="creative"] .report-title { background: linear-gradient(45deg, #ec4899, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 900; text-align: center; }
        [data-theme="creative"] .report-header { text-align: center; }

        /* Fonts */
        .font-sans { font-family: var(--font-sans) !important; }
        .font-serif { font-family: var(--font-serif) !important; }
        .font-academic { font-family: var(--font-academic) !important; }
        .font-kufi { font-family: var(--font-kufi) !important; font-weight: bold; }
        .font-digital { font-family: var(--font-digital) !important; letter-spacing: -1px; }

        /* Icons */
        .icon { display: inline-block; width: 16px; height: 16px; position: relative; }
        .icon-plus::before, .icon-plus::after { content: ''; position: absolute; background: currentColor; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .icon-plus::before { width: 2px; height: 10px; }
        .icon-plus::after { width: 10px; height: 2px; }
        .icon-trash { border: 2px solid currentColor; border-top: none; width: 10px; height: 10px; margin: 2px auto 0; border-radius: 0 0 2px 2px; }
        .icon-trash::before { content: ''; position: absolute; top: -3px; left: -2px; width: 14px; height: 2px; background: currentColor; }

        /* =========================================
           7. RESPONSIVE & PRINT
           ========================================= */
        @media (max-width: 900px) {
            #view-cover { flex-direction: column; }
            .preview-panel { padding-bottom: 20px; display: block; }
            .a4-wrapper { transform: scale(0.42); transform-origin: top center; margin: 0 auto; }
            .editor-wrapper { transform: scale(0.9); transform-origin: top center; width: 100%; }
            .editor-paper { padding: 15mm; }
            .controls-panel { position: static; }
        }
        
        @media (min-width: 901px) and (max-width: 1200px) {
            .a4-wrapper { transform: scale(0.65); transform-origin: top center; }
        }
        @media (min-width: 1201px) {
            .a4-wrapper { transform: scale(0.75); transform-origin: top center; }
        }

        /* STRICT PRINT RULES */
        @media print {
            body { 
                background: white; 
                display: block; 
                margin: 0; padding: 0; 
                overflow: visible;
                height: auto;
            }

            /* Hide Navigation and Tools */
            .main-nav, .controls-panel, .editor-toolbar, .btn, .bg-orb, .editor-stats { 
                display: none !important; 
            }

            .app-container { max-width: none; width: 100%; display: block; }
            
            /* FORCE BOTH SECTIONS TO SHOW IN ORDER */
            .section-view { display: block !important; opacity: 1 !important; transform: none !important; }
            
            /* 1. Cover Page Print Style */
            #view-cover { 
                display: block !important; 
                page-break-after: always; /* Force break after cover */
            }
            .preview-panel { display: block; padding: 0; width: 100%; }
            
            #a4Page {
                position: relative;
                width: 100%; max-width: 210mm;
                min-height: 297mm;
                margin: 0 auto;
                padding: 20mm;
                box-shadow: none; border: none;
                transform: none !important;
                page-break-after: always;
            }

            /* 2. Content Print Style */
            #view-editor { 
                display: block !important; 
                margin-top: 0;
                width: 100%;
            }
            .editor-wrapper { max-width: none; width: 100%; margin: 0; transform: none !important; }
            
            .editor-paper {
                box-shadow: none;
                padding: 0 20mm; /* Use margins for print */
                margin: 0 auto;
                width: 100%; max-width: 210mm;
                min-height: auto; /* Let content flow */
                overflow: visible;
            }

            /* Page Breaks inside Editor */
            .page-break-marker { 
                border: none; margin: 0; height: 0; 
                page-break-after: always; 
                visibility: hidden; /* Hide the dashed line and text */
            }

            /* Fix themes for print */
            [data-theme="modern"]::before { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            [data-theme="corporate"] { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>
    <div class="bg-orb bg-orb-1"></div>
    <div class="bg-orb bg-orb-2"></div>

    <!-- MAIN NAVIGATION -->
    <nav class="main-nav">
        <div class="nav-item active" onclick="switchTab('cover')">
            <span>ğŸ¨</span> ØªØµÙ…ÙŠÙ… Ø§Ù„ØºÙ„Ø§Ù
        </div>
        <div class="nav-item" onclick="switchTab('editor')">
            <span>ğŸ“</span> ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        </div>
    </nav>

    <div class="app-container">
        
        <!-- SECTION 1: COVER DESIGN -->
        <section id="view-cover" class="section-view active">
            <!-- Controls Panel -->
            <aside class="controls-panel">
                <h1>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØºÙ„Ø§Ù</h1>
                <div class="settings-grid">
                    <div class="form-group">
                        <label>Ø§Ù„ØªØµÙ…ÙŠÙ… (Theme)</label>
                        <select id="themeSelect" onchange="updateTheme()">
                            <option value="formal">Ø±Ø³Ù…ÙŠ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</option>
                            <option value="modern">Ù…ÙˆØ¯Ø±Ù† (Ø£Ø²Ø±Ù‚)</option>
                            <option value="corporate">Ø´Ø±ÙƒØ§Øª (Corporate)</option>
                            <option value="elegant">Ø£Ù†ÙŠÙ‚ (Elegant)</option>
                            <option value="creative">Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ (Creative)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø·</label>
                        <select id="fontSelect" onchange="updateFont()">
                            <option value="font-sans">Ø­Ø¯ÙŠØ« (Sans)</option>
                            <option value="font-serif">ØªÙ‚Ù„ÙŠØ¯ÙŠ (Serif)</option>
                            <option value="font-academic">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ù†Ø³Ø®)</option>
                            <option value="font-kufi">ÙƒÙˆÙÙŠ (Ø¹Ø±ÙŠØ¶)</option>
                            <option value="font-digital">Ø±Ù‚Ù…ÙŠ (Ø¢Ù„Ø© ÙƒØ§ØªØ¨Ø©)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© / Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</label>
                    <input type="text" id="uniName" placeholder="Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±</label>
                    <input type="text" id="reportTitle" placeholder="ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù</label>
                    <input type="text" id="supervisorName" placeholder="Ø¯. Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ†</label>
                    <div id="studentsContainer" class="student-list">
                        <div class="student-entry">
                            <input type="text" class="student-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" oninput="updatePreview()" value="Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø£ÙˆÙ„">
                        </div>
                    </div>
                    <button class="btn btn-add" onclick="addStudentField()"><span class="icon icon-plus"></span> Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</button>
                </div>
                <div class="form-group">
                     <label>Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                     <input type="text" id="yearText" placeholder="2024 - 2025" oninput="updatePreview()">
                </div>
            </aside>

            <!-- Preview Panel -->
            <main class="preview-panel">
                <div id="a4Page" class="a4-wrapper font-sans" data-theme="formal">
                    <div class="report-content-wrapper">
                        <div class="report-header">
                            <div class="uni-logo-placeholder">ğŸ›ï¸</div>
                            <h2 class="uni-name-text" id="prevUni">Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…</h2>
                        </div>
                        <div class="report-body">
                            <h1 class="report-title" id="prevTitle">ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ Ø§Ù„Ø·Ø¨</h1>
                            <div class="report-meta">
                                <div class="meta-row"><span class="meta-label">Ø¥Ø´Ø±Ø§Ù:</span><span class="meta-value" id="prevSupervisor">Ø¯. Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯</span></div>
                                <div class="meta-row" style="align-items: flex-start;"><span class="meta-label">Ø¥Ø¹Ø¯Ø§Ø¯:</span><div class="meta-value students-grid" id="prevStudents"><div class="student-item">Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø£ÙˆÙ„</div></div></div>
                                <div class="meta-row"><span class="meta-label">Ø§Ù„Ø¹Ø§Ù…:</span><span class="meta-value" id="prevYear">2024 - 2025</span></div>
                            </div>
                        </div>
                        <footer class="report-footer"></footer>
                    </div>
                </div>
            </main>
        </section>

        <!-- SECTION 2: REPORT WRITING -->
        <section id="view-editor" class="section-view">
            <div class="editor-wrapper">
                
                <!-- Editor Toolbar -->
                <div class="editor-toolbar">
                    <div class="tool-group">
                        <button class="tool-btn" onclick="execCmd('justifyRight')" title="Ù…Ø­Ø§Ø°Ø§Ø© Ù„Ù„ÙŠÙ…ÙŠÙ†">â¡ï¸</button>
                        <button class="tool-btn" onclick="execCmd('justifyCenter')" title="ØªÙˆØ³Ø·">â†”ï¸</button>
                        <button class="tool-btn" onclick="execCmd('justifyLeft')" title="Ù…Ø­Ø§Ø°Ø§Ø© Ù„Ù„ÙŠØ³Ø§Ø±">â¬…ï¸</button>
                    </div>
                    <div class="tool-group">
                        <button class="tool-btn" onclick="execCmd('bold')" title="Ø¹Ø±ÙŠØ¶"><b>B</b></button>
                        <button class="tool-btn" onclick="execCmd('italic')" title="Ù…Ø§Ø¦Ù„"><i>I</i></button>
                        <button class="tool-btn" onclick="execCmd('underline')" title="ØªØ³Ø·ÙŠØ±"><u>U</u></button>
                    </div>
                    <div class="tool-group">
                        <button class="tool-btn" onclick="changeSize('12pt')" title="Ø®Ø· ØµØºÙŠØ±">S</button>
                        <button class="tool-btn" onclick="changeSize('14pt')" title="Ø®Ø· Ù…ØªÙˆØ³Ø·">M</button>
                        <button class="tool-btn" onclick="changeSize('18pt')" title="Ø®Ø· ÙƒØ¨ÙŠØ±">L</button>
                    </div>
                    <div class="tool-group">
                        <button class="tool-btn" onclick="insertPageBreak()" title="Ø¥Ø¶Ø§ÙØ© ØµÙØ­Ø© Ø¬Ø¯ÙŠØ¯Ø©">ğŸ“„+ ÙØ§ØµÙ„ ØµÙØ­Ø§Øª</button>
                        <button class="tool-btn" onclick="clearFormat()" title="Ù…Ø³Ø­ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚">ğŸ§¹</button>
                    </div>
                    <div class="tool-group" style="margin-right: auto;">
                        <input type="checkbox" id="showHeaders" onchange="toggleHeaders()" checked> 
                        <label for="showHeaders" style="display:inline; margin:0; cursor:pointer; font-size:0.9rem">Ø±Ø¤ÙˆØ³ Ø§Ù„ØµÙØ­Ø§Øª</label>
                    </div>
                </div>

                <!-- Editor Paper -->
                <div id="reportHeader" class="editor-stats" style="display:none; justify-content:space-between; margin-bottom:10px; border-bottom:1px solid #ddd; padding-bottom:5px;">
                    <span id="headerTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±</span>
                    <span id="headerName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</span>
                </div>

                <div id="reportEditor" class="editor-paper font-sans" contenteditable="true" oninput="saveContent(); updateStats()"></div>

                <div class="editor-stats">
                    <span id="wordCount">0 ÙƒÙ„Ù…Ø©</span> | 
                    <span id="pageCount">1 ØµÙØ­Ø© (ØªÙ‚Ø¯ÙŠØ±ÙŠ)</span>
                </div>

                <button class="btn btn-print" onclick="window.print()">
                    Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ (Ø§Ù„ØºÙ„Ø§Ù + Ø§Ù„Ù…Ø­ØªÙˆÙ‰)
                    <span style="font-size:1.2em">ğŸ–¨ï¸</span>
                </button>
            </div>
        </section>

    </div>

    <script>
        // =========================================
        // JAVASCRIPT LOGIC
        // =========================================

        const studentsContainer = document.getElementById('studentsContainer');
        const prevStudents = document.getElementById('prevStudents');
        const a4Page = document.getElementById('a4Page');
        const reportEditor = document.getElementById('reportEditor');

        // --- TAB NAVIGATION ---
        function switchTab(tabName) {
            // Update Nav UI
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // Switch Sections
            document.querySelectorAll('.section-view').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${tabName}`).classList.add('active');

            // Sync Data when switching to editor
            if(tabName === 'editor') syncHeaderData();
        }

        // --- COVER LOGIC ---
        function updateTheme() {
            const theme = document.getElementById('themeSelect').value;
            a4Page.setAttribute('data-theme', theme);
        }

        function updateFont() {
            const font = document.getElementById('fontSelect').value;
            // Update Cover Font
            a4Page.className = `a4-wrapper ${font}`;
            // Update Editor Font to match
            reportEditor.className = `editor-paper ${font}`;
        }

        function addStudentField() {
            const div = document.createElement('div');
            div.className = 'student-entry';
            div.innerHTML = `
                <input type="text" class="student-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" oninput="updatePreview()">
                <button class="btn btn-remove btn-icon" onclick="removeStudent(this)"><span class="icon icon-trash"></span></button>
            `;
            studentsContainer.appendChild(div);
            div.querySelector('input').focus();
            updatePreview();
        }

        function removeStudent(btn) {
            if (document.querySelectorAll('.student-input').length > 1) {
                btn.parentElement.remove();
                updatePreview();
            } else {
                btn.previousElementSibling.value = '';
                updatePreview();
            }
        }

        function updatePreview() {
            setText('prevUni', 'uniName', 'Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - ÙƒÙ„ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ…');
            setText('prevTitle', 'reportTitle', 'ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ Ø§Ù„Ø·Ø¨');
            setText('prevSupervisor', 'supervisorName', 'Ø¯. Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯');
            setText('prevYear', 'yearText', '2024 - 2025');

            const inputs = document.querySelectorAll('.student-input');
            prevStudents.innerHTML = '';
            inputs.forEach(input => {
                const name = input.value.trim();
                if (name) {
                    const div = document.createElement('div');
                    div.className = 'student-item';
                    div.textContent = name;
                    prevStudents.appendChild(div);
                }
            });
            if (prevStudents.children.length === 0) {
                prevStudents.innerHTML = '<div class="student-item" style="opacity:0.5">...</div>';
            }
            
            // Auto sync headers if editor is open
            syncHeaderData();
        }

        function setText(targetId, inputId, defaultText) {
            const el = document.getElementById(inputId);
            const val = el.value || defaultText;
            document.getElementById(targetId).textContent = val;
            return val;
        }

        // --- EDITOR LOGIC ---
        
        // Editor Commands
        function execCmd(command, value = null) {
            document.execCommand(command, false, value);
            reportEditor.focus();
        }

        function changeSize(size) {
            // Apply font size to selection via span to allow mixed sizes
            // Using execCommand fontSize is limited (1-7), so we use styleWithCSS or insertHTML
            // Simple approach for this app: Toggle class on current block or insert span
            const sel = window.getSelection();
            if (sel.rangeCount) {
                const span = document.createElement("span");
                span.style.fontSize = size;
                span.textContent = sel.toString();
                if (sel.toString().length > 0) {
                    execCmd('insertHTML', span.outerHTML);
                } else {
                    // If no selection, just change editor base style (simple mode)
                    reportEditor.style.fontSize = size;
                }
            }
        }

        function clearFormat() {
            execCmd('removeFormat');
            execCmd('unlink');
        }

        function insertPageBreak() {
            const pageBreak = `<div class="page-break-marker" contenteditable="false"></div><br>`;
            execCmd('insertHTML', pageBreak);
        }

        // Stats & Persistence
        function saveContent() {
            localStorage.setItem('reportContent', reportEditor.innerHTML);
        }

        function loadContent() {
            const saved = localStorage.getItem('reportContent');
            if (saved) reportEditor.innerHTML = saved;
        }

        function updateStats() {
            const text = reportEditor.innerText || '';
            const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
            document.getElementById('wordCount').textContent = words + ' ÙƒÙ„Ù…Ø©';
            
            // Estimate pages (avg 300 words per page or by height)
            const height = reportEditor.scrollHeight;
            const pageHeight = 1122; // approx A4 px at 96dpi
            const estPages = Math.ceil(height / pageHeight) || 1;
            document.getElementById('pageCount').textContent = estPages + ' ØµÙØ­Ø© (ØªÙ‚Ø¯ÙŠØ±ÙŠ)';
        }

        // Sync Header/Footer Data
        function syncHeaderData() {
            const title = document.getElementById('reportTitle').value || 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±';
            const firstStudent = document.querySelector('.student-input').value || 'Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨';
            
            document.getElementById('headerTitle').textContent = title;
            document.getElementById('headerName').textContent = firstStudent;
        }

        function toggleHeaders() {
            const show = document.getElementById('showHeaders').checked;
            document.getElementById('reportHeader').style.display = show ? 'flex' : 'none';
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            updatePreview();
            loadContent();
            updateStats();
        };

    </script>
</body>
</html>
